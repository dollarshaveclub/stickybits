/**
  stickybits - Stickybits is a lightweight alternative to `position: sticky` polyfills
  @version v3.2.1
  @link https://github.com/dollarshaveclub/stickybits#readme
  @author Jeff Wainwright <yowainwright@gmail.com> (https://jeffry.in)
  @license MIT
**/
function Stickybits(t,s){var i=void 0!==s?s:{};this.version='"3.2.1"',this.userAgent=window.navigator.userAgent||"no `userAgent` provided by the browser",this.props={customStickyChangeNumber:i.customStickyChangeNumber||null,noStyles:i.noStyles||!1,stickyBitStickyOffset:i.stickyBitStickyOffset||0,parentClass:i.parentClass||"js-stickybit-parent",scrollEl:document.querySelector(i.scrollEl)||window,stickyClass:i.stickyClass||"js-is-sticky",stuckClass:i.stuckClass||"js-is-stuck",stickyChangeClass:i.stickyChangeClass||"js-is-sticky--change",useStickyClasses:i.useStickyClasses||!1,verticalPosition:i.verticalPosition||"top"};var e=this.props;e.positionVal=this.definePosition()||"fixed";var n=e.verticalPosition,o=e.noStyles,a=e.positionVal;this.els="string"==typeof t?document.querySelectorAll(t):t,"length"in this.els||(this.els=[this.els]),this.instances=[];for(var r=0;r<this.els.length;r+=1){var c=this.els[r],l=c.style;if(l[n]="top"!==n||o?"":e.stickyBitStickyOffset+"px",l.position="fixed"!==a?a:"","fixed"===a||e.useStickyClasses){var p=this.addInstance(c,e);this.instances.push(p)}}return this}function stickybits(t,s){return new Stickybits(t,s)}Stickybits.prototype.definePosition=function(){for(var t=["","-o-","-webkit-","-moz-","-ms-"],s=document.head.style,i=0;i<t.length;i+=1)s.position=t[i]+"sticky";var e=s.position?s.position:"fixed";return s.position="",e},Stickybits.prototype.addInstance=function(t,s){var i=this,e={el:t,parent:t.parentNode,props:s};this.isWin=this.props.scrollEl===window;var n=this.isWin?window:this.getClosestParent(e.el,e.props.scrollEl);return this.computeScrollOffsets(e),e.parent.className+=" "+s.parentClass,e.state="default",e.stateContainer=function(){return i.manageState(e)},n.addEventListener("scroll",e.stateContainer),e},Stickybits.prototype.getClosestParent=function(t,s){var i=s,e=t;if(e.parentElement===i)return i;for(;e.parentElement!==i;)e=e.parentElement;return i},Stickybits.prototype.computeScrollOffsets=function(t){var s=t,i=s.props,e=s.el,n=s.parent,o=!this.isWin&&"fixed"===i.positionVal,a="bottom"!==i.verticalPosition,r=o?i.scrollEl.getBoundingClientRect().top:0,c=o?n.getBoundingClientRect().top-r:n.getBoundingClientRect().top,l=null!==i.customStickyChangeNumber?i.customStickyChangeNumber:e.offsetHeight;return s.offset=r+i.stickyBitStickyOffset,s.stickyStart=a?c-s.offset:0,s.stickyChange=s.stickyStart+l,s.stickyStop=a?c+n.offsetHeight-(s.el.offsetHeight+s.offset):c+n.offsetHeight,s},Stickybits.prototype.toggleClasses=function(t,s,i){var e=t,n=e.className.split(" ");i&&-1===n.indexOf(i)&&n.push(i);var o=n.indexOf(s);-1!==o&&n.splice(o,1),e.className=n.join(" ")},Stickybits.prototype.manageState=function(t){var s=t,i=s.el,e=s.props,n=s.state,o=s.stickyStart,a=s.stickyChange,r=s.stickyStop,c=i.style,l=e.noStyles,p=e.positionVal,u=e.scrollEl,y=e.stickyClass,f=e.stickyChangeClass,k=e.stuckClass,h=e.verticalPosition,d=function(t){t()},g=this.isWin&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame)||d,m=this.toggleClasses,C=this.isWin||u.getBoundingClientRect().top?window.scrollY||window.pageYOffset:u.scrollTop,S=C<=o&&"sticky"===n,v=C>=r&&"sticky"===n;C>o&&C<r&&("default"===n||"stuck"===n)?(s.state="sticky",g(function(){m(i,k,y),c.position=p,l||(c.bottom="",c[h]=e.stickyBitStickyOffset+"px")})):S?(s.state="default",g(function(){m(i,y),"fixed"===p&&(c.position="")})):v&&(s.state="stuck",g(function(){m(i,y,k),"fixed"!==p||l||(c.top="",c.bottom="0",c.position="absolute")}));var b=C>=a&&C<=r;return C<a||C>r?g(function(){m(i,f)}):b&&g(function(){m(i,"stub",f)}),s},Stickybits.prototype.removeInstance=function(t){var s=t.el,i=t.props,e=this.toggleClasses;s.style.position="",s.style[i.verticalPosition]="",e(s,i.stickyClass),e(s,i.stuckClass),e(s.parentNode,i.parentClass)},Stickybits.prototype.cleanup=function(){for(var t=0;t<this.instances.length;t+=1){var s=this.instances[t];s.props.scrollEl.removeEventListener("scroll",s.stateContainer),this.removeInstance(s)}this.manageState=!1,this.instances=[]};export default stickybits;
